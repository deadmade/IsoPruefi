<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IsoPruefi Arduino: src/core.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IsoPruefi Arduino
   </div>
   <div id="projectbrief">Arduino firmware for IsoPruefi temperature monitoring system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">core.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="platform_8h_source.html">platform.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_8h_source.html">core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mqtt_8h_source.html">mqtt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sensor_8h_source.html">sensor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="storage_8h_source.html">storage.h</a>&quot;</code><br />
<code>#include &quot;secrets.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adfa37a786a938fa0bb795aeb59829e30" id="r_adfa37a786a938fa0bb795aeb59829e30"><td class="memItemLeft" align="right" valign="top">MqttClient&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#adfa37a786a938fa0bb795aeb59829e30">mqttClient</a> (<a class="el" href="core_8cpp.html#a64f7c60366b0a82c42d7a1dbf4e9505a">wifiClient</a>)</td></tr>
<tr class="separator:adfa37a786a938fa0bb795aeb59829e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2926b332df58811bd7c1903d4f43201" id="r_ad2926b332df58811bd7c1903d4f43201"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#ad2926b332df58811bd7c1903d4f43201">IsWifiConnected</a> ()</td></tr>
<tr class="separator:ad2926b332df58811bd7c1903d4f43201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f7d21be0a2e633ba6377e12e8dd8b9" id="r_a48f7d21be0a2e633ba6377e12e8dd8b9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a48f7d21be0a2e633ba6377e12e8dd8b9">IsMqttConnected</a> ()</td></tr>
<tr class="separator:a48f7d21be0a2e633ba6377e12e8dd8b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3497f9bddce44ba60bc1629f84d93de5" id="r_a3497f9bddce44ba60bc1629f84d93de5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a3497f9bddce44ba60bc1629f84d93de5">FatDateTime</a> (uint16_t *date, uint16_t *time)</td></tr>
<tr class="memdesc:a3497f9bddce44ba60bc1629f84d93de5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for FAT file system timestamp generation.  <br /></td></tr>
<tr class="separator:a3497f9bddce44ba60bc1629f84d93de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2663357b0b9fda0a3b6f6c4456daa12" id="r_ab2663357b0b9fda0a3b6f6c4456daa12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#ab2663357b0b9fda0a3b6f6c4456daa12">CoreSetup</a> ()</td></tr>
<tr class="memdesc:ab2663357b0b9fda0a3b6f6c4456daa12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes all core system components and peripherals.  <br /></td></tr>
<tr class="separator:ab2663357b0b9fda0a3b6f6c4456daa12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0006ee50cb0bc41312da546591a02a" id="r_add0006ee50cb0bc41312da546591a02a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#add0006ee50cb0bc41312da546591a02a">CoreLoop</a> ()</td></tr>
<tr class="memdesc:add0006ee50cb0bc41312da546591a02a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main operational loop for continuous sensor monitoring, MQTT transmission, and robust data recovery.  <br /></td></tr>
<tr class="separator:add0006ee50cb0bc41312da546591a02a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afa042f998806fcdedab1794cebbeaad3" id="r_afa042f998806fcdedab1794cebbeaad3"><td class="memItemLeft" align="right" valign="top">RTC_DS3231&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#afa042f998806fcdedab1794cebbeaad3">rtc</a></td></tr>
<tr class="separator:afa042f998806fcdedab1794cebbeaad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19292dee25d42580f9588b754ddbedc" id="r_af19292dee25d42580f9588b754ddbedc"><td class="memItemLeft" align="right" valign="top">Adafruit_ADT7410&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#af19292dee25d42580f9588b754ddbedc">tempsensor</a></td></tr>
<tr class="separator:af19292dee25d42580f9588b754ddbedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15e6b7e1f0fb2d1e0fe1654721bb5302" id="r_a15e6b7e1f0fb2d1e0fe1654721bb5302"><td class="memItemLeft" align="right" valign="top">SdFat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a15e6b7e1f0fb2d1e0fe1654721bb5302">sd</a></td></tr>
<tr class="separator:a15e6b7e1f0fb2d1e0fe1654721bb5302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f7c60366b0a82c42d7a1dbf4e9505a" id="r_a64f7c60366b0a82c42d7a1dbf4e9505a"><td class="memItemLeft" align="right" valign="top">static WiFiClient&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a64f7c60366b0a82c42d7a1dbf4e9505a">wifiClient</a></td></tr>
<tr class="separator:a64f7c60366b0a82c42d7a1dbf4e9505a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bfef4541b1ec66995ff9c8b021477aa" id="r_a0bfef4541b1ec66995ff9c8b021477aa"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a0bfef4541b1ec66995ff9c8b021477aa">CHIP_SELECT</a> = 4</td></tr>
<tr class="memdesc:a0bfef4541b1ec66995ff9c8b021477aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">SD card chip select pin.  <br /></td></tr>
<tr class="separator:a0bfef4541b1ec66995ff9c8b021477aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfea6785b2b85c4960d78d8c64a1af5d" id="r_adfea6785b2b85c4960d78d8c64a1af5d"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#adfea6785b2b85c4960d78d8c64a1af5d">SENSOR_ID_ONE</a> = &quot;Sensor_One&quot;</td></tr>
<tr class="separator:adfea6785b2b85c4960d78d8c64a1af5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39c7b615eef006be10de618816f53ff" id="r_ae39c7b615eef006be10de618816f53ff"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#ae39c7b615eef006be10de618816f53ff">SENSOR_ID_IN_USE</a> = <a class="el" href="core_8cpp.html#adfea6785b2b85c4960d78d8c64a1af5d">SENSOR_ID_ONE</a></td></tr>
<tr class="separator:ae39c7b615eef006be10de618816f53ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ef1d2106c9b7b3de9f778ebede0759" id="r_aa4ef1d2106c9b7b3de9f778ebede0759"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#aa4ef1d2106c9b7b3de9f778ebede0759">SENSOR_TYPE</a> = &quot;temp&quot;</td></tr>
<tr class="separator:aa4ef1d2106c9b7b3de9f778ebede0759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd5f45e37e0f16b34932c4cc0662f89" id="r_a8bd5f45e37e0f16b34932c4cc0662f89"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a8bd5f45e37e0f16b34932c4cc0662f89">MQTT_TOPIC</a> = &quot;dhbw/ai/si2023/2/&quot;</td></tr>
<tr class="separator:a8bd5f45e37e0f16b34932c4cc0662f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7578cbf8a2ac9a8a2ccb3fc5431791" id="r_a9b7578cbf8a2ac9a8a2ccb3fc5431791"><td class="memItemLeft" align="right" valign="top">static const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a9b7578cbf8a2ac9a8a2ccb3fc5431791">WIFI_CONNECT_TIMEOUT_MS</a> = 15000</td></tr>
<tr class="separator:a9b7578cbf8a2ac9a8a2ccb3fc5431791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b3766a24a11a11d57c6ba9114d992b" id="r_aa9b3766a24a11a11d57c6ba9114d992b"><td class="memItemLeft" align="right" valign="top">static const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#aa9b3766a24a11a11d57c6ba9114d992b">LOOP_DELAY_MS</a> = 1000</td></tr>
<tr class="separator:aa9b3766a24a11a11d57c6ba9114d992b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae62406649dce01eb479e7a476a4305" id="r_a4ae62406649dce01eb479e7a476a4305"><td class="memItemLeft" align="right" valign="top">static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a4ae62406649dce01eb479e7a476a4305">CLIENT_ID_BUFFER_SIZE</a> = 64</td></tr>
<tr class="separator:a4ae62406649dce01eb479e7a476a4305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1edbd0b6c65e5e7843bbda20bb24e2" id="r_a4f1edbd0b6c65e5e7843bbda20bb24e2"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a4f1edbd0b6c65e5e7843bbda20bb24e2">SD_SCK_FREQUENCY_MHZ</a> = 25</td></tr>
<tr class="separator:a4f1edbd0b6c65e5e7843bbda20bb24e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cef1bc6ccf08999da59db3b88095f7d" id="r_a6cef1bc6ccf08999da59db3b88095f7d"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a6cef1bc6ccf08999da59db3b88095f7d">RECONNECT_INTERVAL_MS</a> = 2000</td></tr>
<tr class="separator:a6cef1bc6ccf08999da59db3b88095f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6f4167f4e2989c5f0af6f10b56d33e" id="r_abb6f4167f4e2989c5f0af6f10b56d33e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#abb6f4167f4e2989c5f0af6f10b56d33e">lastLoggedMinute</a> = -1</td></tr>
<tr class="separator:abb6f4167f4e2989c5f0af6f10b56d33e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b178b120a91fef15ac5ee30dd89577f" id="r_a5b178b120a91fef15ac5ee30dd89577f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#a5b178b120a91fef15ac5ee30dd89577f">seqCount</a> = 0</td></tr>
<tr class="separator:a5b178b120a91fef15ac5ee30dd89577f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbf27d030d949842a4ac592daa50f7e" id="r_adbbf27d030d949842a4ac592daa50f7e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#adbbf27d030d949842a4ac592daa50f7e">recoverySent</a> = false</td></tr>
<tr class="separator:adbbf27d030d949842a4ac592daa50f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3b6475cc9f45c2f6c244acb67c64f7" id="r_aca3b6475cc9f45c2f6c244acb67c64f7"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8cpp.html#aca3b6475cc9f45c2f6c244acb67c64f7">lastReconnectAttempt</a> = 0</td></tr>
<tr class="separator:aca3b6475cc9f45c2f6c244acb67c64f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="add0006ee50cb0bc41312da546591a02a" name="add0006ee50cb0bc41312da546591a02a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add0006ee50cb0bc41312da546591a02a">&#9670;&#160;</a></span>CoreLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoreLoop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main operational loop for continuous sensor monitoring, MQTT transmission, and robust data recovery. </p>
<p>This function implements the primary logic for the temperature monitoring system, including:</p><ul>
<li>Real-time sensor measurement and transmission via MQTT with QoS 1</li>
<li>Intelligent WiFi and MQTT connection management with automatic reconnection</li>
<li>Fallback to CSV batch storage during connectivity outages</li>
<li>Recovery and transmission of offline data after successful reconnection</li>
<li>Comprehensive error handling and status reporting</li>
</ul>
<p>**Operational Flow:** 1. Time Management: Reads current time from RTC, tracks minute changes to avoid duplicate measurements. 2. WiFi Connection: Monitors status, attempts reconnection, falls back to CSV logging if offline. 3. MQTT Connection: Verifies broker connectivity, reconnects as needed, falls back to CSV logging if offline. 4. Data Recovery: Sends pending CSV data after reconnection, ensures recovery only once per cycle. 5. Normal Operation: Measures temperature, transmits via MQTT, polls for incoming messages.</p>
<p>**Error Handling:**</p><ul>
<li>Network or broker failures trigger CSV fallback storage for all measurements.</li>
<li>Connection attempts are rate-limited to prevent resource exhaustion.</li>
<li>All measurement data is preserved and recovered after connectivity is restored.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Maintains a fixed loop delay for consistent timing and system stability. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="core_8cpp.html#a6cef1bc6ccf08999da59db3b88095f7d">RECONNECT_INTERVAL_MS</a>, <a class="el" href="core_8cpp.html#aa9b3766a24a11a11d57c6ba9114d992b">LOOP_DELAY_MS</a> for timing configuration </dd>
<dd>
saveToCsvBatch() for offline data storage </dd>
<dd>
sendPendingData() for data recovery and MQTT retransmission </dd></dl>

</div>
</div>
<a id="ab2663357b0b9fda0a3b6f6c4456daa12" name="ab2663357b0b9fda0a3b6f6c4456daa12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2663357b0b9fda0a3b6f6c4456daa12">&#9670;&#160;</a></span>CoreSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoreSetup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes all core system components and peripherals. </p>
<p>This function performs comprehensive system initialization including:</p>
<p>**Network Setup:**</p><ul>
<li>Establishes WiFi connection with timeout handling</li>
<li>Configures MQTT client with unique sensor-based ID</li>
<li>Attempts initial MQTT broker connection</li>
</ul>
<p>**Hardware Initialization:**</p><ul>
<li>Initializes DS3231 real-time clock module</li>
<li>Adjusts RTC time if power was lost (uses compilation timestamp)</li>
<li>Sets up SD card with SPI communication</li>
<li>Initializes ADT7410 temperature sensor</li>
</ul>
<p>**Data Recovery:**</p><ul>
<li>Registers FAT file system timestamp callback</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>This function will halt program execution (infinite loop) if any critical component fails to initialize (RTC, SD card, or temperature sensor)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function uses compile-time constants for timeouts and configuration </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="core_8cpp.html#a9b7578cbf8a2ac9a8a2ccb3fc5431791">WIFI_CONNECT_TIMEOUT_MS</a>, <a class="el" href="core_8cpp.html#a4ae62406649dce01eb479e7a476a4305">CLIENT_ID_BUFFER_SIZE</a>, <a class="el" href="core_8cpp.html#a4f1edbd0b6c65e5e7843bbda20bb24e2">SD_SCK_FREQUENCY_MHZ</a> </dd></dl>

</div>
</div>
<a id="a3497f9bddce44ba60bc1629f84d93de5" name="a3497f9bddce44ba60bc1629f84d93de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3497f9bddce44ba60bc1629f84d93de5">&#9670;&#160;</a></span>FatDateTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FatDateTime </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for FAT file system timestamp generation. </p>
<p>This function is used by the SdFat library to obtain current date and time for file system operations. It retrieves the time from the RTC and converts it to the FAT file system format using the appropriate macros.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">date</td><td>Pointer to store the encoded FAT date (year, month, day) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">time</td><td>Pointer to store the encoded FAT time (hour, minute, second)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is registered as a callback with SdFile::dateTimeCallback() </dd></dl>
<dl class="section see"><dt>See also</dt><dd>FAT_DATE, FAT_TIME macros for encoding format details </dd></dl>

</div>
</div>
<a id="a48f7d21be0a2e633ba6377e12e8dd8b9" name="a48f7d21be0a2e633ba6377e12e8dd8b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f7d21be0a2e633ba6377e12e8dd8b9">&#9670;&#160;</a></span>IsMqttConnected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsMqttConnected </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2926b332df58811bd7c1903d4f43201" name="ad2926b332df58811bd7c1903d4f43201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2926b332df58811bd7c1903d4f43201">&#9670;&#160;</a></span>IsWifiConnected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsWifiConnected </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adfa37a786a938fa0bb795aeb59829e30" name="adfa37a786a938fa0bb795aeb59829e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfa37a786a938fa0bb795aeb59829e30">&#9670;&#160;</a></span>mqttClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MqttClient mqttClient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="core_8cpp.html#a64f7c60366b0a82c42d7a1dbf4e9505a">wifiClient</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0bfef4541b1ec66995ff9c8b021477aa" name="a0bfef4541b1ec66995ff9c8b021477aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bfef4541b1ec66995ff9c8b021477aa">&#9670;&#160;</a></span>CHIP_SELECT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t CHIP_SELECT = 4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>SD card chip select pin. </p>

</div>
</div>
<a id="a4ae62406649dce01eb479e7a476a4305" name="a4ae62406649dce01eb479e7a476a4305"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae62406649dce01eb479e7a476a4305">&#9670;&#160;</a></span>CLIENT_ID_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t CLIENT_ID_BUFFER_SIZE = 64</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abb6f4167f4e2989c5f0af6f10b56d33e" name="abb6f4167f4e2989c5f0af6f10b56d33e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6f4167f4e2989c5f0af6f10b56d33e">&#9670;&#160;</a></span>lastLoggedMinute</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lastLoggedMinute = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aca3b6475cc9f45c2f6c244acb67c64f7" name="aca3b6475cc9f45c2f6c244acb67c64f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca3b6475cc9f45c2f6c244acb67c64f7">&#9670;&#160;</a></span>lastReconnectAttempt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long lastReconnectAttempt = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa9b3766a24a11a11d57c6ba9114d992b" name="aa9b3766a24a11a11d57c6ba9114d992b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9b3766a24a11a11d57c6ba9114d992b">&#9670;&#160;</a></span>LOOP_DELAY_MS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned long LOOP_DELAY_MS = 1000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8bd5f45e37e0f16b34932c4cc0662f89" name="a8bd5f45e37e0f16b34932c4cc0662f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd5f45e37e0f16b34932c4cc0662f89">&#9670;&#160;</a></span>MQTT_TOPIC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* MQTT_TOPIC = &quot;dhbw/ai/si2023/2/&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6cef1bc6ccf08999da59db3b88095f7d" name="a6cef1bc6ccf08999da59db3b88095f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cef1bc6ccf08999da59db3b88095f7d">&#9670;&#160;</a></span>RECONNECT_INTERVAL_MS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int RECONNECT_INTERVAL_MS = 2000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adbbf27d030d949842a4ac592daa50f7e" name="adbbf27d030d949842a4ac592daa50f7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbf27d030d949842a4ac592daa50f7e">&#9670;&#160;</a></span>recoverySent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool recoverySent = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa042f998806fcdedab1794cebbeaad3" name="afa042f998806fcdedab1794cebbeaad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa042f998806fcdedab1794cebbeaad3">&#9670;&#160;</a></span>rtc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RTC_DS3231 rtc</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a15e6b7e1f0fb2d1e0fe1654721bb5302" name="a15e6b7e1f0fb2d1e0fe1654721bb5302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15e6b7e1f0fb2d1e0fe1654721bb5302">&#9670;&#160;</a></span>sd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SdFat sd</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4f1edbd0b6c65e5e7843bbda20bb24e2" name="a4f1edbd0b6c65e5e7843bbda20bb24e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f1edbd0b6c65e5e7843bbda20bb24e2">&#9670;&#160;</a></span>SD_SCK_FREQUENCY_MHZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t SD_SCK_FREQUENCY_MHZ = 25</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae39c7b615eef006be10de618816f53ff" name="ae39c7b615eef006be10de618816f53ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39c7b615eef006be10de618816f53ff">&#9670;&#160;</a></span>SENSOR_ID_IN_USE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* SENSOR_ID_IN_USE = <a class="el" href="core_8cpp.html#adfea6785b2b85c4960d78d8c64a1af5d">SENSOR_ID_ONE</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adfea6785b2b85c4960d78d8c64a1af5d" name="adfea6785b2b85c4960d78d8c64a1af5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfea6785b2b85c4960d78d8c64a1af5d">&#9670;&#160;</a></span>SENSOR_ID_ONE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* SENSOR_ID_ONE = &quot;Sensor_One&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa4ef1d2106c9b7b3de9f778ebede0759" name="aa4ef1d2106c9b7b3de9f778ebede0759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ef1d2106c9b7b3de9f778ebede0759">&#9670;&#160;</a></span>SENSOR_TYPE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* SENSOR_TYPE = &quot;temp&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5b178b120a91fef15ac5ee30dd89577f" name="a5b178b120a91fef15ac5ee30dd89577f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b178b120a91fef15ac5ee30dd89577f">&#9670;&#160;</a></span>seqCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int seqCount = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af19292dee25d42580f9588b754ddbedc" name="af19292dee25d42580f9588b754ddbedc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19292dee25d42580f9588b754ddbedc">&#9670;&#160;</a></span>tempsensor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Adafruit_ADT7410 tempsensor</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b7578cbf8a2ac9a8a2ccb3fc5431791" name="a9b7578cbf8a2ac9a8a2ccb3fc5431791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7578cbf8a2ac9a8a2ccb3fc5431791">&#9670;&#160;</a></span>WIFI_CONNECT_TIMEOUT_MS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned long WIFI_CONNECT_TIMEOUT_MS = 15000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64f7c60366b0a82c42d7a1dbf4e9505a" name="a64f7c60366b0a82c42d7a1dbf4e9505a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64f7c60366b0a82c42d7a1dbf4e9505a">&#9670;&#160;</a></span>wifiClient</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">WiFiClient wifiClient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
