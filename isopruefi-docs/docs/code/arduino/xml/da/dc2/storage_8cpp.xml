<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.14.0" xml:lang="en-US">
  <compounddef id="da/dc2/storage_8cpp" kind="file" language="C++">
    <compoundname>storage.cpp</compoundname>
    <includes refid="d8/d6b/storage_8h" local="yes">storage.h</includes>
    <incdepgraph>
      <node id="8">
        <label>Adafruit_ADT7410.h</label>
      </node>
      <node id="4">
        <label>Arduino.h</label>
      </node>
      <node id="9">
        <label>ArduinoJson.h</label>
      </node>
      <node id="10">
        <label>ArduinoMqttClient.h</label>
      </node>
      <node id="3">
        <label>platform.h</label>
        <link refid="de/d03/platform_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>storage.h</label>
        <link refid="d8/d6b/storage_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/storage.cpp</label>
        <link refid="da/dc2/storage_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>RTClib.h</label>
      </node>
      <node id="6">
        <label>SdFat.h</label>
      </node>
      <node id="5">
        <label>Wire.h</label>
      </node>
      <node id="11">
        <label>cstdio</label>
      </node>
    </incdepgraph>
    <sectiondef kind="var">
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a01d5af4481e953ac242d59bd4c22765f" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t SMALL_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>SMALL_BUFFER_SIZE</name>
        <initializer>= 32</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="4" column="21" bodyfile="src/storage.cpp" bodystart="4" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a09f5fe9f2f18854f57bac91913060821" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t MEDIUM_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>MEDIUM_BUFFER_SIZE</name>
        <initializer>= 128</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="5" column="21" bodyfile="src/storage.cpp" bodystart="5" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1abafcc50ab7d3b296d64e26083a1a876e" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t LARGE_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>LARGE_BUFFER_SIZE</name>
        <initializer>= 256</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="6" column="21" bodyfile="src/storage.cpp" bodystart="6" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a376b9e2756cc0b9b2db6d6d35b5d554d" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t XLARGE_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>XLARGE_BUFFER_SIZE</name>
        <initializer>= 1024</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="7" column="21" bodyfile="src/storage.cpp" bodystart="7" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a633b6d91d2a6b9fe94d49679bf76cf8d" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t FOLDER_NAME_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>FOLDER_NAME_BUFFER_SIZE</name>
        <initializer>= 8</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="8" column="21" bodyfile="src/storage.cpp" bodystart="8" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a58ee493fbe4f650e9becc0e32cf30bf4" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t RECOVERED_NAME_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>RECOVERED_NAME_BUFFER_SIZE</name>
        <initializer>= 40</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="9" column="21" bodyfile="src/storage.cpp" bodystart="9" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1aa4d6a09459b76d7be490a8804e8bffe4" prot="public" static="yes" mutable="no">
        <type>const size_t</type>
        <definition>const size_t FILE_NAME_BUFFER_SIZE</definition>
        <argsstring></argsstring>
        <name>FILE_NAME_BUFFER_SIZE</name>
        <initializer>= 64</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="10" column="21" bodyfile="src/storage.cpp" bodystart="10" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a10aaa940168502f25286e34dd53f08a0" prot="public" static="yes" mutable="no">
        <type>const int</type>
        <definition>const int FILE_EXTENSION_LENGTH</definition>
        <argsstring></argsstring>
        <name>FILE_EXTENSION_LENGTH</name>
        <initializer>= 5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="11" column="18" bodyfile="src/storage.cpp" bodystart="11" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="da/dc2/storage_8cpp_1a700fb0855fc0d557992d5068df21e937" prot="public" static="yes" mutable="no">
        <type>const uint32_t</type>
        <definition>const uint32_t SECONDS_IN_24_HOURS</definition>
        <argsstring></argsstring>
        <name>SECONDS_IN_24_HOURS</name>
        <initializer>= 86400</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="12" column="23" bodyfile="src/storage.cpp" bodystart="12" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="da/dc2/storage_8cpp_1ab16364c7bad54765d7deca604d19f172" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void buildJson</definition>
        <argsstring>(JsonDocument &amp;doc, float celsius, const DateTime &amp;now, int sequence)</argsstring>
        <name>buildJson</name>
        <param>
          <type><ref refid="db/d72/mock__json_8h_1a54db1bfd55a2f11a001e5854071c899c" kindref="member">JsonDocument</ref> &amp;</type>
          <declname>doc</declname>
        </param>
        <param>
          <type>float</type>
          <declname>celsius</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <param>
          <type>int</type>
          <declname>sequence</declname>
        </param>
        <briefdescription>
<para>Builds a JSON document for sensor data. </para>
        </briefdescription>
        <detaileddescription>
<para>Creates a standardized JSON structure containing sensor reading, timestamp, sequence number, and metadata fields.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>doc</parametername>
</parameternamelist>
<parameterdescription>
<para>JSON document to populate with sensor data. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>celsius</parametername>
</parameternamelist>
<parameterdescription>
<para>Temperature reading in Celsius. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for timestamp. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>sequence</parametername>
</parameternamelist>
<parameterdescription>
<para>Sequence number for the reading. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="25" column="6" bodyfile="src/storage.cpp" bodystart="25" bodyend="32"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a49ffb7f647d6701d9cea3decdac97cf1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void buildRecoveredJson</definition>
        <argsstring>(JsonDocument &amp;doc, String *fileList, int count, const DateTime &amp;now)</argsstring>
        <name>buildRecoveredJson</name>
        <param>
          <type><ref refid="db/d72/mock__json_8h_1a54db1bfd55a2f11a001e5854071c899c" kindref="member">JsonDocument</ref> &amp;</type>
          <declname>doc</declname>
        </param>
        <param>
          <type>String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>count</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <briefdescription>
<para>Builds a JSON document containing recovered sensor data from multiple files. </para>
        </briefdescription>
        <detaileddescription>
<para>Reads multiple JSON files from storage, parses them, and consolidates their contents into a single JSON document with metadata array containing all recovered entries.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>doc</parametername>
</parameternamelist>
<parameterdescription>
<para>JSON document to populate with recovered data. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of file paths to read and consolidate. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of files in the fileList array. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for the recovery timestamp. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="46" column="6" bodyfile="src/storage.cpp" bodystart="46" bodyend="80"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a03d6491b13757e01963c2ed90e52aa5f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void saveDataToSD</definition>
        <argsstring>(float celsius, const DateTime &amp;now, int sequence)</argsstring>
        <name>saveDataToSD</name>
        <param>
          <type>float</type>
          <declname>celsius</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <param>
          <type>int</type>
          <declname>sequence</declname>
        </param>
        <briefdescription>
<para>Wrapper function to save sensor data to SD card using global SD instance. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>celsius</parametername>
</parameternamelist>
<parameterdescription>
<para>Temperature reading in Celsius. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for timestamp and file organization. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>sequence</parametername>
</parameternamelist>
<parameterdescription>
<para>Sequence number for the reading. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="89" column="6" bodyfile="src/storage.cpp" bodystart="89" bodyend="91"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1aec99e2896ee5b3c8e188437407b97357" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void saveToSD</definition>
        <argsstring>(SdFat &amp;sdRef, float celsius, const DateTime &amp;now, int sequence)</argsstring>
        <name>saveToSD</name>
        <param>
          <type>SdFat &amp;</type>
          <declname>sdRef</declname>
        </param>
        <param>
          <type>float</type>
          <declname>celsius</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <param>
          <type>int</type>
          <declname>sequence</declname>
        </param>
        <briefdescription>
<para>Saves sensor data to SD card as a JSON file. </para>
        </briefdescription>
        <detaileddescription>
<para>Creates a JSON document with sensor data and saves it to the SD card in a date-organized folder structure. Creates directories as needed and handles file writing with proper timestamping.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sdRef</parametername>
</parameternamelist>
<parameterdescription>
<para>Reference to the SD card file system instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>celsius</parametername>
</parameternamelist>
<parameterdescription>
<para>Temperature reading in Celsius. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for timestamp and file organization. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>sequence</parametername>
</parameternamelist>
<parameterdescription>
<para>Sequence number for the reading. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="105" column="6" bodyfile="src/storage.cpp" bodystart="105" bodyend="135"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a9b1aef5a070bc35c2abe6ef4721e421b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void saveRecoveredJsonDataToSd</definition>
        <argsstring>(String *fileList, int count, const DateTime &amp;now)</argsstring>
        <name>saveRecoveredJsonDataToSd</name>
        <param>
          <type>String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>count</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <briefdescription>
<para>Wrapper function to save recovered JSON data using global SD instance. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of file paths that were recovered. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of files in the array. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for filename generation. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="144" column="6" bodyfile="src/storage.cpp" bodystart="144" bodyend="146"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a104eb1fa19e5eb32fc2465c1d994b242" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void saveRecoveredJsonToSd</definition>
        <argsstring>(SdFat &amp;sdRef, String *fileList, int count, const DateTime &amp;now)</argsstring>
        <name>saveRecoveredJsonToSd</name>
        <param>
          <type>SdFat &amp;</type>
          <declname>sdRef</declname>
        </param>
        <param>
          <type>String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>count</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <briefdescription>
<para>Saves consolidated recovered sensor data to SD card as a single JSON file. </para>
        </briefdescription>
        <detaileddescription>
<para>Takes multiple recovered sensor data entries and saves them as one consolidated JSON file with a &quot;_recovered&quot; suffix. This file serves as a backup of the data that was sent to the MQTT broker.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sdRef</parametername>
</parameternamelist>
<parameterdescription>
<para>Reference to the SD card file system instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of original file paths that were recovered. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of files in the array. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for filename generation. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="160" column="6" bodyfile="src/storage.cpp" bodystart="160" bodyend="182"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a4ebfbb31311cdc384f46f28627733869" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int listSavedFilesData</definition>
        <argsstring>(String *fileList, int maxFiles, const DateTime &amp;now)</argsstring>
        <name>listSavedFilesData</name>
        <param>
          <type>String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxFiles</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <briefdescription>
<para>Wrapper function to list saved files using global SD instance. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array to store the found file paths. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>maxFiles</parametername>
</parameternamelist>
<parameterdescription>
<para>Maximum number of files to list. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for filtering files within 24 hours. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Number of files found and added to the list. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="192" column="5" bodyfile="src/storage.cpp" bodystart="192" bodyend="194"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a1bad01efdba2c79507efa46876326e50" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int listSavedFiles</definition>
        <argsstring>(SdFat &amp;sdRef, String *fileList, int maxFiles, const DateTime &amp;now)</argsstring>
        <name>listSavedFiles</name>
        <param>
          <type>SdFat &amp;</type>
          <declname>sdRef</declname>
        </param>
        <param>
          <type>String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxFiles</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <briefdescription>
<para>Lists saved sensor data files from the last 24 hours. </para>
        </briefdescription>
        <detaileddescription>
<para>Scans the SD card for JSON files in the current date folder, filters them based on their timestamp to include only files from the last 24 hours, and excludes recovery files.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sdRef</parametername>
</parameternamelist>
<parameterdescription>
<para>Reference to the SD card file system instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array to store the found file paths. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>maxFiles</parametername>
</parameternamelist>
<parameterdescription>
<para>Maximum number of files to list. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for filtering files within 24 hours. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Number of files found and added to the list. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="209" column="5" bodyfile="src/storage.cpp" bodystart="209" bodyend="254"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a655fe9b7f9b52e408b888ce3aadd62a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void deleteRecoveredAndPendingSourceFilesData</definition>
        <argsstring>(const String *fileList, int count, const DateTime &amp;now, const String &amp;recoveredFilename)</argsstring>
        <name>deleteRecoveredAndPendingSourceFilesData</name>
        <param>
          <type>const String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>count</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <param>
          <type>const String &amp;</type>
          <declname>recoveredFilename</declname>
        </param>
        <briefdescription>
<para>Wrapper function to delete recovered and pending files using global SD instance. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of original file paths to delete. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of files in the array. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for folder path generation. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>recoveredFilename</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the recovery file to delete. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="264" column="6" bodyfile="src/storage.cpp" bodystart="264" bodyend="266"/>
      </memberdef>
      <memberdef kind="function" id="da/dc2/storage_8cpp_1a2a56012e4c76aa4f343b849a0d926c93" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void deleteRecoveredAndPendingSourceFiles</definition>
        <argsstring>(SdFat &amp;sdRef, const String *fileList, int count, const DateTime &amp;now, const String &amp;recoveredFilename)</argsstring>
        <name>deleteRecoveredAndPendingSourceFiles</name>
        <param>
          <type>SdFat &amp;</type>
          <declname>sdRef</declname>
        </param>
        <param>
          <type>const String *</type>
          <declname>fileList</declname>
        </param>
        <param>
          <type>int</type>
          <declname>count</declname>
        </param>
        <param>
          <type>const DateTime &amp;</type>
          <declname>now</declname>
        </param>
        <param>
          <type>const String &amp;</type>
          <declname>recoveredFilename</declname>
        </param>
        <briefdescription>
<para>Deletes original sensor data files and the recovery file after successful transmission. </para>
        </briefdescription>
        <detaileddescription>
<para>Removes the original sensor data files that were consolidated and sent, as well as the recovery file that was created as backup. This cleanup prevents duplicate data transmission and manages storage space.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sdRef</parametername>
</parameternamelist>
<parameterdescription>
<para>Reference to the SD card file system instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fileList</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of original file paths to delete. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>count</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of files in the array. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>now</parametername>
</parameternamelist>
<parameterdescription>
<para>Current date and time for folder path generation. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>recoveredFilename</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of the recovery file to delete. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/storage.cpp" line="281" column="6" bodyfile="src/storage.cpp" bodystart="281" bodyend="300"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d8/d6b/storage_8h" kindref="compound">storage.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Storage<sp/>and<sp/>JSON<sp/>buffer<sp/>size<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="d8/d5b/mqtt_8cpp_1a01d5af4481e953ac242d59bd4c22765f" kindref="member">SMALL_BUFFER_SIZE</ref><sp/>=<sp/>32;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>filenames<sp/>and<sp/>base<sp/>names</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a09f5fe9f2f18854f57bac91913060821" kindref="member">MEDIUM_BUFFER_SIZE</ref><sp/>=<sp/>128;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>small<sp/>JSON<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="d8/d5b/mqtt_8cpp_1abafcc50ab7d3b296d64e26083a1a876e" kindref="member">LARGE_BUFFER_SIZE</ref><sp/>=<sp/>256;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>JSON<sp/>entries<sp/>and<sp/>buffers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a376b9e2756cc0b9b2db6d6d35b5d554d" kindref="member">XLARGE_BUFFER_SIZE</ref><sp/>=<sp/>1024;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>large<sp/>JSON<sp/>docs<sp/>and<sp/>buffers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a633b6d91d2a6b9fe94d49679bf76cf8d" kindref="member">FOLDER_NAME_BUFFER_SIZE</ref><sp/>=<sp/>8;</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a58ee493fbe4f650e9becc0e32cf30bf4" kindref="member">RECOVERED_NAME_BUFFER_SIZE</ref><sp/>=<sp/>40;</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1aa4d6a09459b76d7be490a8804e8bffe4" kindref="member">FILE_NAME_BUFFER_SIZE</ref><sp/>=<sp/>64;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d8/d5b/mqtt_8cpp_1a10aaa940168502f25286e34dd53f08a0" kindref="member">FILE_EXTENSION_LENGTH</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/><ref refid="da/dc2/storage_8cpp_1a700fb0855fc0d557992d5068df21e937" kindref="member">SECONDS_IN_24_HOURS</ref><sp/>=<sp/>86400;</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1ab16364c7bad54765d7deca604d19f172" kindref="member">buildJson</ref>(<ref refid="db/d72/mock__json_8h_1a54db1bfd55a2f11a001e5854071c899c" kindref="member">JsonDocument</ref>&amp;<sp/>doc,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>celsius,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sequence)<sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/>doc.clear();</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/>doc[</highlight><highlight class="stringliteral">&quot;timestamp&quot;</highlight><highlight class="normal">]<sp/>=<sp/>now.unixtime();</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><ref refid="db/d72/mock__json_8h_1a23d227a500ab50420b35be152ef0a5e4" kindref="member">JsonArray</ref><sp/>arr<sp/>=<sp/>doc.createNestedArray(</highlight><highlight class="stringliteral">&quot;value&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/>arr.add(celsius);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/>doc[</highlight><highlight class="stringliteral">&quot;sequence&quot;</highlight><highlight class="normal">]<sp/>=<sp/>sequence;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/>doc.createNestedArray(</highlight><highlight class="stringliteral">&quot;meta&quot;</highlight><highlight class="normal">).add(</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="32"><highlight class="normal">}</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a49ffb7f647d6701d9cea3decdac97cf1" kindref="member">buildRecoveredJson</ref>(<ref refid="db/d72/mock__json_8h_1a54db1bfd55a2f11a001e5854071c899c" kindref="member">JsonDocument</ref>&amp;<sp/>doc,<sp/>String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now)<sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/>doc.clear();</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>doc[</highlight><highlight class="stringliteral">&quot;timestamp&quot;</highlight><highlight class="normal">]<sp/>=<sp/>now.unixtime();</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/>doc[</highlight><highlight class="stringliteral">&quot;sequence&quot;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><ref refid="db/d72/mock__json_8h_1a23d227a500ab50420b35be152ef0a5e4" kindref="member">JsonArray</ref><sp/>val<sp/>=<sp/>doc.createNestedArray(</highlight><highlight class="stringliteral">&quot;value&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/>val.add(</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><ref refid="db/d72/mock__json_8h_1a23d227a500ab50420b35be152ef0a5e4" kindref="member">JsonArray</ref><sp/>meta<sp/>=<sp/>doc.createNestedArray(</highlight><highlight class="stringliteral">&quot;meta&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.print(</highlight><highlight class="stringliteral">&quot;Trying<sp/>to<sp/>open:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(fileList[i]);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>File<sp/>file<sp/>=<sp/><ref refid="de/d03/platform_8h_1a15e6b7e1f0fb2d1e0fe1654721bb5302" kindref="member">sd</ref>.open(fileList[i].c_str(),<sp/>FILE_READ);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!file)<sp/>{</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;<sp/>-&gt;<sp/>Failed<sp/>to<sp/>open<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>StaticJsonDocument&lt;LARGE_BUFFER_SIZE&gt;<sp/>entry;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>DeserializationError<sp/>err<sp/>=<sp/>deserializeJson(entry,<sp/>file);</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>file.close();</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.print(</highlight><highlight class="stringliteral">&quot;<sp/>-&gt;<sp/>Failed<sp/>to<sp/>parse<sp/>JSON:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(err.c_str());</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;<sp/>-&gt;<sp/>Parsed<sp/>and<sp/>added<sp/>to<sp/>meta.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>meta.add(entry);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/>Serial.print(</highlight><highlight class="stringliteral">&quot;Total<sp/>valid<sp/>entries<sp/>added<sp/>to<sp/>meta:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>Serial.println(meta.size());</highlight></codeline>
<codeline lineno="80"><highlight class="normal">}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a03d6491b13757e01963c2ed90e52aa5f" kindref="member">saveDataToSD</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>celsius,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sequence)<sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><ref refid="da/dc2/storage_8cpp_1aec99e2896ee5b3c8e188437407b97357" kindref="member">saveToSD</ref>(<ref refid="de/d03/platform_8h_1a15e6b7e1f0fb2d1e0fe1654721bb5302" kindref="member">sd</ref>,<sp/>celsius,<sp/>now,<sp/>sequence);<sp/></highlight></codeline>
<codeline lineno="91"><highlight class="normal">}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1aec99e2896ee5b3c8e188437407b97357" kindref="member">saveToSD</ref>(SdFat&amp;<sp/>sdRef,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>celsius,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sequence)<sp/>{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Saving<sp/>data<sp/>to<sp/>SD<sp/>card...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/>StaticJsonDocument&lt;LARGE_BUFFER_SIZE&gt;<sp/>doc;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><ref refid="da/dc2/storage_8cpp_1ab16364c7bad54765d7deca604d19f172" kindref="member">buildJson</ref>(doc,<sp/>celsius,<sp/>now,<sp/>sequence);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>folder[<ref refid="da/dc2/storage_8cpp_1a633b6d91d2a6b9fe94d49679bf76cf8d" kindref="member">FOLDER_NAME_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/>strncpy(folder,<sp/><ref refid="d8/d6b/storage_8h_1a5abff0f0bde3f6a3197f25893c1e0b8e" kindref="member">createFolderName</ref>(now),<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(folder));</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sdRef.exists(folder))<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sdRef.mkdir(folder))<sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>create<sp/>folder.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>filename[<ref refid="d8/d5b/mqtt_8cpp_1a01d5af4481e953ac242d59bd4c22765f" kindref="member">SMALL_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><ref refid="d8/d6b/storage_8h_1a99398dc180671d28434aa4982bfd36ca" kindref="member">createFilename</ref>(filename,<sp/><ref refid="d8/d5b/mqtt_8cpp_1a01d5af4481e953ac242d59bd4c22765f" kindref="member">SMALL_BUFFER_SIZE</ref>,<sp/>now);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/>File<sp/>file<sp/>=<sp/>sdRef.open(filename,<sp/>FILE_WRITE);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(file)<sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Write<sp/>JSON<sp/>to<sp/>a<sp/>buffer,<sp/>then<sp/>write<sp/>buffer<sp/>to<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>jsonBuffer[<ref refid="d8/d5b/mqtt_8cpp_1abafcc50ab7d3b296d64e26083a1a876e" kindref="member">LARGE_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len<sp/>=<sp/>serializeJson(doc,<sp/>jsonBuffer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(jsonBuffer));</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>file.write((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t*)jsonBuffer,<sp/>len);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>file.close();</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.print(</highlight><highlight class="stringliteral">&quot;Saved<sp/>JSON<sp/>to<sp/>SD<sp/>card:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(filename);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>write<sp/>file.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal">}</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a9b1aef5a070bc35c2abe6ef4721e421b" kindref="member">saveRecoveredJsonDataToSd</ref>(String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now)<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><ref refid="da/dc2/storage_8cpp_1a104eb1fa19e5eb32fc2465c1d994b242" kindref="member">saveRecoveredJsonToSd</ref>(<ref refid="de/d03/platform_8h_1a15e6b7e1f0fb2d1e0fe1654721bb5302" kindref="member">sd</ref>,<sp/>fileList,<sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/>now);</highlight></codeline>
<codeline lineno="146"><highlight class="normal">}</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a104eb1fa19e5eb32fc2465c1d994b242" kindref="member">saveRecoveredJsonToSd</ref>(SdFat&amp;<sp/>sdRef,<sp/>String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now)<sp/>{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Saving<sp/>recovered<sp/>JSON<sp/>to<sp/>SD...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/>StaticJsonDocument&lt;XLARGE_BUFFER_SIZE&gt;<sp/>doc;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><ref refid="da/dc2/storage_8cpp_1a49ffb7f647d6701d9cea3decdac97cf1" kindref="member">buildRecoveredJson</ref>(doc,<sp/>fileList,<sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/>now);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>baseName[<ref refid="d8/d5b/mqtt_8cpp_1a01d5af4481e953ac242d59bd4c22765f" kindref="member">SMALL_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><ref refid="d8/d6b/storage_8h_1a99398dc180671d28434aa4982bfd36ca" kindref="member">createFilename</ref>(baseName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(baseName),<sp/>now);<sp/></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>recoveredName[<ref refid="da/dc2/storage_8cpp_1a58ee493fbe4f650e9becc0e32cf30bf4" kindref="member">RECOVERED_NAME_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>snprintf(recoveredName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(recoveredName),<sp/></highlight><highlight class="stringliteral">&quot;%.*s_recovered.json&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(strlen(baseName)<sp/>-<sp/><ref refid="d8/d5b/mqtt_8cpp_1a10aaa940168502f25286e34dd53f08a0" kindref="member">FILE_EXTENSION_LENGTH</ref>),<sp/>baseName);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/>File<sp/>file<sp/>=<sp/>sdRef.open(recoveredName,<sp/>FILE_WRITE);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(file)<sp/>{</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>jsonBuffer[<ref refid="da/dc2/storage_8cpp_1a376b9e2756cc0b9b2db6d6d35b5d554d" kindref="member">XLARGE_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len<sp/>=<sp/>serializeJson(doc,<sp/>jsonBuffer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(jsonBuffer));</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>file.write((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t*)jsonBuffer,<sp/>len);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>file.close();</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Saved<sp/>recovered<sp/>JSON<sp/>to<sp/>SD:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>String(recoveredName));</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>save<sp/>recovered<sp/>JSON.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="182"><highlight class="normal">}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a4ebfbb31311cdc384f46f28627733869" kindref="member">listSavedFilesData</ref>(String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxFiles,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a1bad01efdba2c79507efa46876326e50" kindref="member">listSavedFiles</ref>(<ref refid="de/d03/platform_8h_1a15e6b7e1f0fb2d1e0fe1654721bb5302" kindref="member">sd</ref>,<sp/>fileList,<sp/>maxFiles,<sp/>now);</highlight></codeline>
<codeline lineno="194"><highlight class="normal">}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a1bad01efdba2c79507efa46876326e50" kindref="member">listSavedFiles</ref>(SdFat&amp;<sp/>sdRef,<sp/>String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxFiles,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now)<sp/>{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Listing<sp/>saved<sp/>files<sp/>from<sp/>last<sp/>24h...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>folder[<ref refid="da/dc2/storage_8cpp_1a633b6d91d2a6b9fe94d49679bf76cf8d" kindref="member">FOLDER_NAME_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>strncpy(folder,<sp/><ref refid="d8/d6b/storage_8h_1a5abff0f0bde3f6a3197f25893c1e0b8e" kindref="member">createFolderName</ref>(now),<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(folder));</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/>File<sp/>root<sp/>=<sp/>sdRef.open(folder);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!root)<sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Folder<sp/>not<sp/>found<sp/>or<sp/>failed<sp/>to<sp/>open.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>File<sp/>entry;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((entry<sp/>=<sp/>root.openNextFile()))<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!entry.isDirectory())<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>name[<ref refid="da/dc2/storage_8cpp_1aa4d6a09459b76d7be490a8804e8bffe4" kindref="member">FILE_NAME_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>entry.getName(name,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(name));</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>nameStr(name);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nameStr.endsWith(</highlight><highlight class="stringliteral">&quot;.json&quot;</highlight><highlight class="normal">)<sp/>||<sp/>nameStr.indexOf(</highlight><highlight class="stringliteral">&quot;_recovered&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>entry.close();</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>StaticJsonDocument&lt;MEDIUM_BUFFER_SIZE&gt;<sp/>doc;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DeserializationError<sp/>err<sp/>=<sp/>deserializeJson(doc,<sp/>entry);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>entry.close();</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!err)<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>ts<sp/>=<sp/>doc[</highlight><highlight class="stringliteral">&quot;timestamp&quot;</highlight><highlight class="normal">]<sp/>|<sp/>0;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ts<sp/>&gt;=<sp/>(now.unixtime()<sp/>-<sp/><ref refid="da/dc2/storage_8cpp_1a700fb0855fc0d557992d5068df21e937" kindref="member">SECONDS_IN_24_HOURS</ref>))<sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref><sp/>&lt;<sp/>maxFiles)<sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>fullPath<sp/>=<sp/>String(folder)<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal"><sp/>+<sp/>nameStr;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileList[<ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>++]<sp/>=<sp/>fullPath;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Adding<sp/>to<sp/>list:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>fullPath);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/>root.close();</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/>Serial.print(</highlight><highlight class="stringliteral">&quot;Total<sp/>matching<sp/>files:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/>Serial.println(<ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>;</highlight></codeline>
<codeline lineno="254"><highlight class="normal">}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a655fe9b7f9b52e408b888ce3aadd62a2" kindref="member">deleteRecoveredAndPendingSourceFilesData</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>String&amp;<sp/>recoveredFilename)<sp/>{</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><ref refid="da/dc2/storage_8cpp_1a2a56012e4c76aa4f343b849a0d926c93" kindref="member">deleteRecoveredAndPendingSourceFiles</ref>(<ref refid="de/d03/platform_8h_1a15e6b7e1f0fb2d1e0fe1654721bb5302" kindref="member">sd</ref>,<sp/>fileList,<sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/>now,<sp/>recoveredFilename);</highlight></codeline>
<codeline lineno="266"><highlight class="normal">}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="da/dc2/storage_8cpp_1a2a56012e4c76aa4f343b849a0d926c93" kindref="member">deleteRecoveredAndPendingSourceFiles</ref>(SdFat&amp;<sp/>sdRef,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>String*<sp/>fileList,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>DateTime&amp;<sp/>now,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>String&amp;<sp/>recoveredFilename)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>folder[<ref refid="da/dc2/storage_8cpp_1a633b6d91d2a6b9fe94d49679bf76cf8d" kindref="member">FOLDER_NAME_BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>strncpy(folder,<sp/><ref refid="d8/d6b/storage_8h_1a5abff0f0bde3f6a3197f25893c1e0b8e" kindref="member">createFolderName</ref>(now),<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(folder));</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="da/de0/core_8cpp_1ad43c3812e6d13e0518d9f8b8f463ffcf" kindref="member">count</ref>;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>fullPath<sp/>=<sp/>String(folder)<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal"><sp/>+<sp/>fileList[i];</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sdRef.remove(fullPath.c_str()))<sp/>{</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Deleted<sp/>file:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>fullPath);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>delete<sp/>file:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>fullPath);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sdRef.exists(recoveredFilename.c_str()))<sp/>{</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sdRef.remove(recoveredFilename.c_str()))<sp/>{</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Deleted<sp/>recovered<sp/>file:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>recoveredFilename);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Serial.println(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>delete<sp/>recovered<sp/>file:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>recoveredFilename);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="300"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="src/storage.cpp"/>
  </compounddef>
</doxygen>
